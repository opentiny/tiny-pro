FROM node:alpine as BUILDER
WORKDIR /builder/
ADD . .
RUN apk add wait4x && \
    npm install pnpm -g && \
    pnpm i && \
    pnpm build

ENV DATABASE_HOST=""
ENV DATABASE_PORT=""
ENV DATABASE_USERNAME=""
ENV DATABASE_PASSWORD=""
ENV DATABASE_USERNAME=""
ENV DATABASE_SYNCHRONIZE=""
ENV DATABASE_AUTOLOADENTITIES=true
ENV AUTH_SECRET=""
ENV REDIS_SECONDS=""
ENV REDIS_HOST=""
ENV REDIS_PORT=""
ENV EXPIRES_IN=""
ENV PAGINATION_PAGE=""
ENV PAGINATION_LIMIT=10
ENV DATABASE_NAME=""

EXPOSE 3000
VOLUME [ "./dist/data" ]
CMD ["sh", "endpoint.sh"]

